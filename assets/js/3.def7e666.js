(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{194:function(t,e,n){t.exports=n(195)},195:function(t,e,n){
/*!
 * 
 * js-audio-recorder - js audio recorder plugin
 * 
 * @version v0.3.1
 * @homepage https://github.com/2fps/recorder
 * @author 2fps <echoweb@126.com> (http://www.zhuyuntao.cn)
 * @license MIT
 *         
 */
window,t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t){void 0===t&&(t={}),this.lBuffer=[],this.rBuffer=[],this.inputSampleBits=16;var e,n=new(window.AudioContext||window.webkitAudioContext);this.inputSampleRate=n.sampleRate,this.config={sampleBits:~[8,16].indexOf(t.sampleBits)?t.sampleBits:16,sampleRate:~[11025,16e3,22050,24e3,44100,48e3].indexOf(t.sampleRate)?t.sampleRate:this.inputSampleRate,numChannels:~[1,2].indexOf(t.numChannels)?t.numChannels:1},this.outputSampleRate=this.config.sampleRate,this.oututSampleBits=this.config.sampleBits,this.littleEdian=(e=new ArrayBuffer(2),new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]),this.initUserMedia()}return t.prototype.initRecorder=function(){var t=this;this.context&&this.destroy(),this.context=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048;var e=this.context.createScriptProcessor||this.context.createJavaScriptNode;this.recorder=e.apply(this.context,[4096,this.config.numChannels,this.config.numChannels]),this.recorder.onaudioprocess=function(e){if(t.isrecording&&!t.ispause){var n=e.inputBuffer.getChannelData(0),o=null;t.lBuffer.push(new Float32Array(n)),t.size+=n.length,2===t.config.numChannels&&(o=e.inputBuffer.getChannelData(1),t.rBuffer.push(new Float32Array(o)),t.size+=o.length),t.duration+=4096/t.inputSampleRate,t.onprocess&&t.onprocess(t.duration)}}},t.prototype.start=function(){var e=this;if(!this.isrecording)return this.clear(),this.initRecorder(),this.isrecording=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){e.audioInput=e.context.createMediaStreamSource(t)},function(e){t.throwError(e.name+" : "+e.message)}).then(function(){e.audioInput.connect(e.analyser),e.analyser.connect(e.recorder),e.recorder.connect(e.context.destination)})},t.prototype.pause=function(){this.isrecording&&!this.ispause&&(this.ispause=!0,this.recorder.disconnect())},t.prototype.resume=function(){this.isrecording&&this.ispause&&(this.ispause=!1,this.audioInput&&this.audioInput.connect(this.analyser),this.analyser.connect(this.recorder),this.recorder.connect(this.context.destination))},t.prototype.stop=function(){this.isrecording=!1,this.audioInput&&this.audioInput.disconnect(),this.recorder.disconnect()},t.prototype.play=function(){var e=this;this.stop(),this.source&&this.source.stop(),this.context.decodeAudioData(this.getWAV().buffer,function(t){e.source=e.context.createBufferSource(),e.source.buffer=t,e.source.connect(e.analyser),e.analyser.connect(e.context.destination),e.source.start()},function(e){t.throwError(e)})},t.prototype.getRecordAnalyseData=function(){if(this.ispause)return this.prevDomainData;var t=new Uint8Array(this.analyser.frequencyBinCount);return this.analyser.getByteTimeDomainData(t),this.prevDomainData=t},t.prototype.getPlayAnalyseData=function(){return this.getRecordAnalyseData()},t.prototype.initUserMedia=function(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise(function(n,o){e.call(navigator,t,n,o)}):Promise.reject(new Error("浏览器不支持 getUserMedia !"))})},t.prototype.getPCM=function(){var e=this.flat();return e=t.compress(e,this.inputSampleRate,this.outputSampleRate),t.encodePCM(e,this.oututSampleBits,this.littleEdian)},t.prototype.getPCMBlob=function(){return new Blob([this.getPCM()])},t.prototype.downloadPCM=function(t){void 0===t&&(t="recorder"),this.stop();var e=this.getPCMBlob();this.download(e,t,"pcm")},t.prototype.getWAV=function(){var e=this.getPCM();return t.encodeWAV(e,this.inputSampleRate,this.outputSampleRate,this.config.numChannels,this.oututSampleBits,this.littleEdian)},t.prototype.getWAVBlob=function(){return new Blob([this.getWAV()],{type:"audio/wav"})},t.prototype.downloadWAV=function(t){void 0===t&&(t="recorder"),this.stop();var e=this.getWAVBlob();this.download(e,t,"wav")},t.prototype.destroy=function(){return this.closeAudioContext()},t.prototype.closeAudioContext=function(){return this.context.close?this.context.close():new Promise(function(t){t()})},t.prototype.download=function(e,n,o){try{var i=document.createElement("a");i.href=window.URL.createObjectURL(e),i.download=n+"."+o,i.click()}catch(e){t.throwError(e)}},t.prototype.clear=function(){this.lBuffer.length=0,this.rBuffer.length=0,this.size=0,this.PCMData=null,this.audioInput=null,this.duration=0,this.ispause=!1,this.source&&(this.source.stop(),this.source=null)},t.prototype.flat=function(){if(this.PCMData)return this.PCMData;var t=null,e=new Float32Array(0);1===this.config.numChannels?t=new Float32Array(this.size):(t=new Float32Array(this.size/2),e=new Float32Array(this.size/2));for(var n=0,o=0;o<this.lBuffer.length;o++)t.set(this.lBuffer[o],n),n+=this.lBuffer[o].length;for(n=0,o=0;o<this.rBuffer.length;o++)e.set(this.rBuffer[o],n),n+=this.rBuffer[o].length;return this.PCMData={left:t,right:e}},t.playAudio=function(t){var e=document.createElement("audio");e.src=window.URL.createObjectURL(t),e.play()},t.compress=function(t,e,n){for(var o=Math.max(Math.floor(e/n),1),i=t.left,r=t.right,a=(i.length+r.length)/o,s=new Float32Array(a),u=0,c=0;u<a;)s[u]=i[c],u++,r.length&&(s[u]=r[c],u++),c+=o;return s},t.encodePCM=function(t,e,n){void 0===n&&(n=!0);var o=0,i=t.length*(e/8),r=new ArrayBuffer(i),a=new DataView(r);if(8===e)for(var s=0;s<t.length;s++,o++){var u=(c=Math.max(-1,Math.min(1,t[s])))<0?128*c:127*c;u=+u+128,a.setInt8(o,u)}else for(s=0;s<t.length;s++,o+=2){var c=Math.max(-1,Math.min(1,t[s]));a.setInt16(o,c<0?32768*c:32767*c,n)}return a},t.encodeWAV=function(t,e,n,o,r,a){void 0===a&&(a=!0);var s=Math.min(e,n),u=r,c=new ArrayBuffer(44+t.byteLength),l=new DataView(c),d=o,h=0;i(l,h,"RIFF"),h+=4,l.setUint32(h,36+t.byteLength,a),i(l,h+=4,"WAVE"),i(l,h+=4,"fmt "),h+=4,l.setUint32(h,16,a),h+=4,l.setUint16(h,1,a),h+=2,l.setUint16(h,d,a),h+=2,l.setUint32(h,s,a),h+=4,l.setUint32(h,d*s*(u/8),a),h+=4,l.setUint16(h,d*(u/8),a),h+=2,l.setUint16(h,u,a),i(l,h+=2,"data"),h+=4,l.setUint32(h,t.byteLength,a),h+=4;for(var p=0;p<t.byteLength;)l.setUint8(h,t.getUint8(p)),h++,p++;return l},t.throwError=function(t){throw new Error(t)},t}();function i(t,e,n){for(var o=0;o<n.length;o++)t.setUint8(e+o,n.charCodeAt(o))}e.default=o}]).default},201:function(t,e,n){"use strict";n.r(e);var o=n(194),i=n.n(o),r=null,a=null,s=null,u=null,c=null,l={data:function(){return{}},mounted:function(){r=document.getElementById("time"),s=document.getElementById("canvas"),u=s.getContext("2d")},methods:{startRecord:function(){a||((a=new i.a({sampleBits:16,numChannels:1})).onprocess=function(t){r.innerHTML=t.toFixed(5)}),a.start().then(function(){console.log("开始录音")}),this.drawRecord()},pauseRecord:function(){a&&a.pause(),console.log("暂停录音")},resumeRecord:function(){a&&a.resume(),console.log("恢复录音")},endRecord:function(t){a&&a.stop(),console.log("结束录音"),c&&cancelAnimationFrame(c),c=null},playRecord:function(){a&&a.play(),console.log("播放录音"),c&&cancelAnimationFrame(c),c=null},destroyRecord:function(){a&&a.destroy().then(function(){console.log("销毁实例"),a=null,c&&cancelAnimationFrame(c)})},downloadPCM:function(){a&&a.downloadPCM()},downloadWAV:function(){a&&a.downloadWAV()},drawRecord:function(){c=requestAnimationFrame(this.drawRecord);var t=a.getRecordAnalyseData(),e=t.length;u.fillStyle="rgb(200, 200, 200)",u.fillRect(0,0,s.width,s.height),u.lineWidth=2,u.strokeStyle="rgb(0, 0, 0)",u.beginPath();for(var n=1*s.width/e,o=0,i=0;i<e;i++){var r=t[i]/128*s.height/2;0===i?u.moveTo(o,r):u.lineTo(o,r),o+=n}u.lineTo(s.width,s.height/2),u.stroke()},initCanvasBg:function(){u.fillStyle="rgb(200, 200, 200)",u.fillRect(0,0,s.width,s.height)},uploadAudio:function(t){i.a.playAudio(t.target.files[0])}}},d=n(3),h=Object(d.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("\n        操作\n    ")]),t._v(" "),n("input",{attrs:{type:"button",value:"录音开启"},on:{click:this.startRecord,touch:t.startRecord}}),t._v(" "),n("input",{attrs:{type:"button",value:"暂停"},on:{click:t.pauseRecord,touch:t.pauseRecord}}),t._v(" "),n("input",{attrs:{type:"button",value:"恢复"},on:{click:t.resumeRecord,touch:t.resumeRecord}}),t._v(" "),n("input",{attrs:{type:"button",value:"录音停止"},on:{click:t.endRecord,touch:t.endRecord}}),t._v(" "),n("input",{attrs:{type:"button",value:"播放录音"},on:{click:t.playRecord,touch:t.playRecord}}),t._v(" "),n("input",{attrs:{type:"button",value:"销毁实例"},on:{click:t.destroyRecord,touch:t.destroyRecord}}),t._v(" "),n("h3",[t._v("\n        下载\n    ")]),t._v(" "),n("input",{attrs:{type:"button",value:"下载pcm"},on:{click:t.downloadPCM,touch:t.downloadPCM}}),t._v(" "),n("input",{attrs:{type:"button",value:"下载wav"},on:{click:t.downloadWAV,touch:t.downloadWAV}}),t._v(" "),t._m(0),t._v(" "),n("h3",[t._v("\n        声音波形图如下：\n    ")]),t._v(" "),n("canvas",{attrs:{id:"canvas"}}),t._v(" "),n("h3",[t._v("\n        加载播放：\n    ")]),t._v(" "),n("input",{attrs:{type:"file",value:"加载文件播放",disabled:""},on:{click:t.uploadAudio,touch:t.uploadAudio}})])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h3",[this._v("\n        录音时长："),e("span",{attrs:{id:"time"}},[this._v("0")]),this._v("s\n    ")])}],!1,null,null,null);e.default=h.exports}}]);